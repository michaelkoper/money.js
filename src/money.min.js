this.Money=(function(){a.currencies={EUR:{fixed:2,name:"euro",factor:100,separator:",",thousands:".",format:function(b){return""+b+" €";}},CLP:{fixed:0,name:"pesos",factor:1,separator:",",thousands:".",format:function(b){return"$"+b;}},USD:{fixed:2,name:"dollar",factor:100,separator:".",thousands:",",format:function(b){return"$"+b;}},GBP:{fixed:2,name:"British Pound",factor:100,separator:".",thousands:",",format:function(b){return"£"+b;}}};a.defaultCurrency="EUR";function a(c,d,b){this.options=b||{};if(d instanceof Object){this.currency=d;}else{this.currency=a.currencies[d]||a.currencies[a.defaultCurrency];}if(c instanceof a){this.cents=c.cents;if(this.currency.name!==c.currency.name){this.currency=c.currency;}}else{if((typeof c==="string")||(c instanceof String)){this.cents=Math.round(c.replace(/\,/,".")*this.currency.factor);}else{if((typeof c==="number")||(c instanceof Number)){this.cents=Math.round(c);}else{this.cents=0;}}}}a.prototype.toString=function(i){var g,f,c,d,e,h,j,b;i=i||{};d=this.currency.fixed;if(i.no_cents){d=0;}g=this.cents/this.currency.factor;e=(g<0?"-":"");b=parseInt(g=Math.abs(+g||0).toFixed(d))+"";f=(f=b.length)>3?f%3:0;h=f?b.substr(0,f)+this.currency.thousands:"";j=b.substr(f).replace(/(\d{3})(?=\d)/g,"$1"+this.currency.thousands);c=(d?this.currency.separator+Math.abs(g-b).toFixed(d).slice(2):"");return e+h+j+c;};a.prototype.formatted=function(b){return this.currency.format(this.toString(b));};a.prototype.dup=function(){return new a(this,this.currency);};a.prototype.add=function(b){return new a(this.cents+b.toMoney(this.currency).cents,this.currency);};a.prototype.subtract=function(b){return new a(this.cents-b.toMoney(this.currency).cents,this.currency);};a.prototype.multiply=function(b){return new a(Math.round(this.cents*b),this.currency);};a.prototype.divide=function(b){return new a(Math.round(this.cents/b),this.currency);};a.prototype.isEqual=function(b){return this.cents===b.cents&&this.currency===b.currency;};a.prototype.isPositive=function(){return this.cents>0;};a.prototype.isNegative=function(){return this.cents<0;};a.prototype.isZero=function(){return this.cents===0;};a.prototype.toMoney=function(b){return this;};return a;})();Number.prototype.toMoney=function(b){var a;a=Money.currencies[b]||Money.currencies[Money.defaultCurrency];return new Money(this,b);};String.prototype.toMoney=function(a){return new Money(this,a);};
